#!/bin/bash

ANCHOR=$(echo "$1" | sed 's/\(.*\)/\L\1/' | tr ' ' '-')

gtfobins=("7z" "aa-exec" "ab" "agetty" "alpine" "ansible-playbook" "ansible-test" "aoss" "apt-get" "apt" "ar" "aria2c" "arj" "arp" "as" "ascii-xfr" "ascii85" "ash" "aspell" "at" "atobm" "awk" "aws" "base32" "base58" "base64" "basenc" "basez" "bash" "batcat" "bc" "bconsole" "bpftrace" "bridge" "bundle" "bundler" "busctl" "busybox" "byebug" "bzip2" "c89" "c99" "cabal" "cancel" "capsh" "cat" "cdist" "certbot" "check_by_ssh" "check_cups" "check_log" "check_memory" "check_raid" "check_ssl_cert" "check_statusfile" "chmod" "choom" "chown" "chroot" "clamscan" "cmp" "cobc" "column" "comm" "composer" "cowsay" "cowthink" "cp" "cpan" "cpio" "cpulimit" "crash" "crontab" "csh" "csplit" "csvtool" "cupsfilter" "curl" "cut" "dash" "date" "dd" "debugfs" "dialog" "diff" "dig" "distcc" "dmesg" "dmidecode" "dmsetup" "dnf" "docker" "dos2unix" "dosbox" "dotnet" "dpkg" "dstat" "dvips" "easy_install" "eb" "ed" "efax" "elvish" "emacs" "env" "eqn" "espeak" "ex" "exiftool" "expand" "expect" "facter" "file" "find" "finger" "fish" "flock" "fmt" "fold" "fping" "ftp" "gawk" "gcc" "gcloud" "gcore" "gdb" "gem" "genie" "genisoimage" "ghc" "ghci" "gimp" "ginsh" "git" "grc" "grep" "gtester" "gzip" "hd" "head" "hexdump" "highlight" "hping3" "iconv" "iftop" "install" "ionice" "ip" "irb" "ispell" "jjs" "joe" "join" "journalctl" "jq" "jrunscript" "jtag" "julia" "knife" "ksh" "ksshell" "ksu" "kubectl" "latex" "latexmk" "ld.so" "ldconfig" "less" "lftp" "ln" "loginctl" "logsave" "look" "lp" "ltrace" "lua" "lualatex" "luatex" "lwp-download" "lwp-request" "mail" "make" "man" "mawk" "minicom" "more" "mosquitto" "mount" "msfconsole" "msgattrib" "msgcat" "msgconv" "msgfilter" "msgmerge" "msguniq" "mtr" "multitime" "mv" "mysql" "nano" "nasm" "nawk" "nc" "ncftp" "neofetch" "nft" "nice" "nl" "nm" "nmap" "node" "nohup" "npm" "nroff" "nsenter" "octave" "od" "openssl" "openvpn" "openvt" "opkg" "pandoc" "paste" "pax" "pdb" "pdflatex" "pdftex" "perf" "perl" "perlbug" "pexec" "pg" "php" "pic" "pico" "pidstat" "pip" "pkexec" "pkg" "posh" "pr" "pry" "psftp" "psql" "ptx" "puppet" "pwsh" "python" "rake" "rc" "readelf" "red" "redcarpet" "redis" "restic" "rev" "rlogin" "rlwrap" "rpm" "rpmdb" "rpmquery" "rpmverify" "rsync" "rtorrent" "ruby" "run-mailcap" "run-parts" "runscript" "rview" "rvim" "sash" "scanmem" "scp" "screen" "script" "scrot" "sed" "service" "setarch" "setfacl" "setlock" "sftp" "sg" "shuf" "slsh" "smbclient" "snap" "socat" "socket" "soelim" "softlimit" "sort" "split" "sqlite3" "sqlmap" "ss" "ssh-agent" "ssh-keygen" "ssh-keyscan" "ssh" "sshpass" "start-stop-daemon" "stdbuf" "strace" "strings" "su" "sysctl" "systemctl" "systemd-resolve" "tac" "tail" "tar" "task" "taskset" "tasksh" "tbl" "tclsh" "tcpdump" "tdbtool" "tee" "telnet" "terraform" "tex" "tftp" "tic" "time" "timedatectl" "timeout" "tmate" "tmux" "top" "torify" "torsocks" "troff" "tshark" "ul" "unexpand" "uniq" "unshare" "unsquashfs" "unzip" "update-alternatives" "uudecode" "uuencode" "vagrant" "valgrind" "vi" "view" "vigr" "vim" "vimdiff" "vipw" "virsh" "volatility" "w3m" "wall" "watch" "wc" "wget" "whiptail" "whois" "wireshark" "wish" "xargs" "xdg-user-dir" "xdotool" "xelatex" "xetex" "xmodmap" "xmore" "xpad" "xxd" "xz" "yarn" "yash" "yelp" "yum" "zathura" "zip" "zsh" "zsoelim" "zypper")
functions=("File read,Sudo" "Shell,SUID,Sudo" "File upload,File download,SUID,Sudo" "SUID" "File read,SUID,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo" "File read,SUID,Sudo" "Command,File download,Sudo,Limited SUID" "File write,File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,Sudo" "Shell,File write,SUID,Sudo" "File read,SUID,Sudo" "Shell,Command,Sudo" "File read,SUID,Sudo" "Shell,Non-interactive reverse shell,Non-interactive bind shell,File write,File read,SUID,Sudo,Limited SUID" "Shell,Sudo" "File read,SUID,Sudo" "File read,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo" "Shell,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,File read,Sudo" "Sudo" "File read,SUID,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,File upload,File write,File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,File write,File read,Sudo" "Shell,File write,File read,Sudo" "Shell,SUID,Sudo" "File upload" "Shell,SUID,Sudo" "File read,SUID,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo" "File read,Sudo" "File write,File read,Sudo" "File read,Sudo" "File read,Sudo" "Command,Sudo" "File read,Sudo" "SUID,Sudo" "Shell,SUID,Sudo" "SUID,Sudo" "SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,Sudo" "Shell,Sudo" "File write,File read,SUID,Sudo" "Shell,Reverse shell,File upload,File download,Sudo" "Shell,File write,File read,SUID,Sudo" "Shell,SUID,Sudo" "Shell,Command,Sudo" "Command,Sudo" "Shell,File write,SUID,Sudo" "File write,File read,SUID,Sudo" "Shell,File write,File read,SUID,Sudo" "File read,SUID,Sudo" "File upload,File download,File write,File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,File write,SUID,Sudo" "File read,SUID,Sudo" "File write,File read,SUID,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "Shell,File read,Sudo" "Sudo" "SUID,Sudo" "Sudo" "Shell,File write,File read,SUID,Sudo" "File write" "File write,File read,SUID,Sudo" "Shell,File read,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo,Limited SUID" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,Sudo" "Shell,Sudo" "Shell,File write,File read,SUID,Sudo,Limited SUID" "SUID,Sudo" "Shell,File write,File read,SUID,Sudo" "Shell,File write,File read,SUID,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,File write,File read,Sudo" "File write,File read,Sudo" "File read,SUID,Sudo" "Shell,File read,SUID,Sudo" "Shell,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "File upload,File download" "Shell,SUID,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,Sudo" "Shell,File upload,File download,Sudo" "Shell,Non-interactive reverse shell,Non-interactive bind shell,File write,File read,SUID,Sudo,Limited SUID" "Shell,File write,File read,Sudo" "Shell,Sudo" "File read,SUID,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities" "Shell,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,File write,File read,Sudo,Limited SUID" "Shell,Sudo" "File read,SUID,Sudo" "Shell,File write,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "File write,File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "SUID,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,Sudo" "Shell,SUID,Sudo" "Shell,Reverse shell,File download,File write,File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,Sudo" "File read,SUID,Sudo" "Shell,Reverse shell,File download,File write,File read,SUID,Sudo" "Shell,Sudo" "Shell,Reverse shell,File download,File write,File read,SUID,Sudo" "Shell,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,SUID,Sudo" "File read,SUID,Sudo" "Sudo" "File upload,SUID,Sudo" "Shell,File read,Sudo,Limited SUID" "Shell,File read,Sudo" "Shell,SUID,Sudo" "Sudo,Limited SUID" "Shell,File write,File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "Sudo" "Shell,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "File upload" "Shell,File write,File read,Sudo" "Shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,SUID,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "File download,File write,File read,Sudo" "File read,Sudo" "Shell,Sudo" "Shell,File write,SUID,Sudo" "Shell,File read,Sudo" "Shell,File write,File read,SUID,Sudo,Limited SUID" "Shell,SUID,Sudo" "Shell,File read,SUID,Sudo" "File read,SUID,Sudo" "Sudo" "Shell,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,Sudo" "Shell,SUID,Sudo" "SUID,Sudo" "Shell,Library load,Sudo,Limited SUID" "Shell,File write,File read,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,Non-interactive reverse shell,Non-interactive bind shell,File write,File read,SUID,Sudo,Limited SUID" "Reverse shell,Bind shell,File upload,File download,Sudo,Limited SUID" "Shell,SUID,Sudo" "Shell,File read,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,SUID,Sudo,Limited SUID" "Shell,Reverse shell,Bind shell,File upload,File download,File write,File read,SUID,Sudo,Capabilities" "Shell,Command,SUID,Sudo" "Shell,Sudo" "Shell,File read,Sudo" "Shell,Sudo" "Shell,File write,File read,Sudo,Limited SUID" "File read,SUID,Sudo" "Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo" "Shell,File read,SUID,Sudo" "Sudo" "Sudo" "File write,File read,SUID,Sudo" "File read,SUID,Sudo" "File read" "Shell,Sudo" "Shell,File read,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "Shell,SUID,Sudo" "Shell,Reverse shell,File read,SUID,Sudo,Capabilities" "Shell,Sudo" "Shell,SUID,Sudo" "Shell,File read,SUID,Sudo" "Shell,Command,Reverse shell,File upload,File download,File write,File read,SUID,Sudo,Capabilities" "Shell,File read,Sudo,Limited SUID" "Shell,File write,File read,Sudo,Limited SUID" "Command,SUID,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,Sudo" "Sudo" "Sudo" "Shell,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "Shell,Sudo" "File read,SUID,Sudo" "Shell,File write,File read,Sudo" "Shell,File write,Sudo" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities" "Shell,File read,Sudo,Limited SUID" "Shell,SUID,Sudo" "File read,SUID,Sudo" "File write,File read,Sudo" "File read,Sudo" "File write" "File upload,SUID,Sudo" "File read,SUID,Sudo" "File upload" "Shell,File write,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "Shell,SUID,Sudo" "Shell,SUID" "Shell,Reverse shell,File upload,File download,File write,File read,Library load,Sudo,Capabilities" "Shell,File write,File read,Sudo" "Shell,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,Reverse shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities,Limited SUID" "Shell,Reverse shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities,Limited SUID" "Shell,SUID,Sudo" "Shell,SUID,Sudo" "Shell,File upload,File download,Sudo,Limited SUID" "Shell,File write,Sudo" "Shell,File write,Sudo" "Shell,Sudo,Limited SUID" "Shell,Command,File write,File read,SUID,Sudo" "Shell,Sudo" "Shell,SUID,Sudo" "SUID,Sudo" "Shell,SUID,Sudo" "Shell,File upload,File download,Sudo" "Shell,Sudo" "File write,File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,File upload,File download,Sudo" "Sudo" "Shell,Reverse shell,Bind shell,File upload,File download,File write,File read,Sudo,Limited SUID" "Reverse shell,Bind shell" "File read,SUID,Sudo" "Shell,SUID,Sudo" "File read,SUID,Sudo" "Shell,Command,File write,File read,Sudo" "Shell,File write,File read,SUID,Sudo,Limited SUID" "Shell,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "Library load,SUID,Sudo" "File read,SUID,Sudo" "Shell,File upload,File download,File read,Sudo" "Shell,SUID,Sudo" "Shell,SUID,Sudo" "Shell,SUID,Sudo" "Shell,File write,SUID,Sudo" "File read,SUID,Sudo" "Sudo" "Command,File read,SUID,Sudo" "SUID,Sudo" "Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,File upload,File download,File write,File read,Sudo,Limited SUID" "Shell,Sudo" "Shell,SUID,Sudo" "Shell,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,Non-interactive reverse shell,SUID,Sudo" "Command,Sudo" "Shell,Sudo,Limited SUID" "File write,SUID,Sudo" "Shell,Reverse shell,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,Sudo,Limited SUID" "File upload,File download,SUID,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "Shell,Sudo" "Shell,SUID,Sudo" "Shell,Sudo,Limited SUID" "Shell,File read,Sudo" "Shell,Sudo" "Shell,Sudo" "Shell,Sudo" "File read,SUID,Sudo" "Shell" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "SUID,Sudo" "SUID,Sudo" "SUID,Sudo" "File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,SUID,Sudo" "Shell,Sudo" "Shell,File write,File read,Sudo" "Shell,Reverse shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities,Limited SUID" "SUID,Sudo" "Shell,Reverse shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities,Limited SUID" "Shell,Reverse shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities,Limited SUID" "SUID,Sudo" "File write,File read,Sudo" "Shell" "File read,SUID,Sudo" "Sudo" "Shell,SUID,Sudo,Limited SUID" "File read,SUID,Sudo" "Shell,File upload,File download,File write,File read,SUID,Sudo" "File read,SUID,Sudo" "File upload,File download" "Command,Sudo" "Shell,Non-interactive reverse shell,Sudo" "Shell,File read,SUID,Sudo" "Shell,Sudo" "Shell,SUID,Sudo" "Shell,File read,Sudo,Limited SUID" "Shell,Sudo,Limited SUID" "File read,SUID,Sudo" "File read,SUID,Sudo" "File read,Sudo" "File write,File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,Sudo" "Shell,SUID,Sudo" "File read" "File download,Sudo" "Shell,Sudo" "Shell,File read,Sudo,Limited SUID" "Shell,File write,File read,SUID,Sudo" "File read,SUID,Sudo" "Shell,Sudo")
for (( i=0; i<${#gtfobins[@]}; i++ )); do
  if [ -z "$1" ] || [[ "${functions[$i]}" == *"$1"* ]]; then
    if which ${gtfobins[$i]} > /dev/null; then
      if [ -z "$1" ]; then
        printf "%-19s ${functions[$i]}\n" "${gtfobins[$i]}"
      else
        printf "%-19s https://gtfobins.github.io/gtfobins/${gtfobins[$i]}/#$ANCHOR\n" "${gtfobins[$i]}"
      fi
    fi
  fi
done
