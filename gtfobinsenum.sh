#!/bin/bash

ANCHOR=$(echo "$1" | sed 's/\(.*\)/\L\1/' | tr ' ' '-')

gtfobins=("7z" "aa-exec" "ab" "agetty" "alpine" "ansible-playbook" "ansible-test" "aoss" "apt-get" "apt" "ar" "aria2c" "arj" "arp" "as" "ascii-xfr" "ascii85" "ash" "aspell" "at" "atobm" "awk" "aws" "base32" "base58" "base64" "basenc" "basez" "bash" "batcat" "bc" "bconsole" "bpftrace" "bridge" "bundle" "bundler" "busctl" "busybox" "byebug" "bzip2" "c89" "c99" "cabal" "cancel" "capsh" "cat" "cdist" "certbot" "check_by_ssh" "check_cups" "check_log" "check_memory" "check_raid" "check_ssl_cert" "check_statusfile" "chmod" "choom" "chown" "chroot" "clamscan" "cmp" "cobc" "column" "comm" "composer" "cowsay" "cowthink" "cp" "cpan" "cpio" "cpulimit" "crash" "crontab" "csh" "csplit" "csvtool" "cupsfilter" "curl" "cut" "dash" "date" "dd" "debugfs" "dialog" "diff" "dig" "distcc" "dmesg" "dmidecode" "dmsetup" "dnf" "docker" "dos2unix" "dosbox" "dotnet" "dpkg" "dstat" "dvips" "easy_install" "eb" "ed" "efax" "elvish" "emacs" "env" "eqn" "espeak" "ex" "exiftool" "expand" "expect" "facter" "file" "find" "finger" "fish" "flock" "fmt" "fold" "fping" "ftp" "gawk" "gcc" "gcloud" "gcore" "gdb" "gem" "genie" "genisoimage" "ghc" "ghci" "gimp" "ginsh" "git" "grc" "grep" "gtester" "gzip" "hd" "head" "hexdump" "highlight" "hping3" "iconv" "iftop" "install" "ionice" "ip" "irb" "ispell" "jjs" "joe" "join" "journalctl" "jq" "jrunscript" "jtag" "julia" "knife" "ksh" "ksshell" "ksu" "kubectl" "latex" "latexmk" "ld.so" "ldconfig" "less" "lftp" "ln" "loginctl" "logsave" "look" "lp" "ltrace" "lua" "lualatex" "luatex" "lwp-download" "lwp-request" "mail" "make" "man" "mawk" "minicom" "more" "mosquitto" "mount" "msfconsole" "msgattrib" "msgcat" "msgconv" "msgfilter" "msgmerge" "msguniq" "mtr" "multitime" "mv" "mysql" "nano" "nasm" "nawk" "nc" "ncftp" "neofetch" "nft" "nice" "nl" "nm" "nmap" "node" "nohup" "npm" "nroff" "nsenter" "octave" "od" "openssl" "openvpn" "openvt" "opkg" "pandoc" "paste" "pax" "pdb" "pdflatex" "pdftex" "perf" "perl" "perlbug" "pexec" "pg" "php" "pic" "pico" "pidstat" "pip" "pkexec" "pkg" "posh" "pr" "pry" "psftp" "psql" "ptx" "puppet" "pwsh" "python" "rake" "rc" "readelf" "red" "redcarpet" "redis" "restic" "rev" "rlogin" "rlwrap" "rpm" "rpmdb" "rpmquery" "rpmverify" "rsync" "rtorrent" "ruby" "run-mailcap" "run-parts" "runscript" "rview" "rvim" "sash" "scanmem" "scp" "screen" "script" "scrot" "sed" "service" "setarch" "setfacl" "setlock" "sftp" "sg" "shuf" "slsh" "smbclient" "snap" "socat" "socket" "soelim" "softlimit" "sort" "split" "sqlite3" "sqlmap" "ss" "ssh-agent" "ssh-keygen" "ssh-keyscan" "ssh" "sshpass" "start-stop-daemon" "stdbuf" "strace" "strings" "su" "sysctl" "systemctl" "systemd-resolve" "tac" "tail" "tar" "task" "taskset" "tasksh" "tbl" "tclsh" "tcpdump" "tdbtool" "tee" "telnet" "terraform" "tex" "tftp" "tic" "time" "timedatectl" "timeout" "tmate" "tmux" "top" "torify" "torsocks" "troff" "tshark" "ul" "unexpand" "uniq" "unshare" "unsquashfs" "unzip" "update-alternatives" "uudecode" "uuencode" "vagrant" "valgrind" "vi" "view" "vigr" "vim" "vimdiff" "vipw" "virsh" "volatility" "w3m" "wall" "watch" "wc" "wget" "whiptail" "whois" "wireshark" "wish" "xargs" "xdg-user-dir" "xdotool" "xelatex" "xetex" "xmodmap" "xmore" "xpad" "xxd" "xz" "yarn" "yash" "yelp" "yum" "zathura" "zip" "zsh" "zsoelim" "zypper")
A="Non-interactive reverse shell"; B="SUID"; C="Limited SUID"; D="Sudo"; E="File write"; F="File upload"; G="Reverse shell"; H="Library load"; I="Bind shell"; J="Capabilities"; K="Non-interactive bind shell"; L="File download"; M="Shell"; N="Command"; O="File read"; P="$O,$D"; Q="$M,$B,$D"; R="$F,$L,$B,$D"; S="$B"; T="$O,$B,$D"; U="$M,$D"; V="$N,$L,$D,$C"; W="$E,$O,$B,$D"; X="$M,$E,$B,$D"; Y="$M,$N,$D"; Z="$M,$A,$K,$E,$O,$B,$D,$C"; AA="$M,$G,$F,$L,$E,$O,$H,$B,$D"; AB="$M,$D,$C"; AC="$M,$O,$D"; AD="$D"; AE="$M,$F,$E,$O,$B,$D"; AF="$M,$E,$O,$D"; AG="$F"; AH="$E,$O,$D"; AI="$N,$D"; AJ="$B,$D"; AK="$M,$G,$F,$L,$D"; AL="$M,$E,$O,$B,$D"; AM="$F,$L,$E,$O,$B,$D"; AN="$E"; AO="$M,$G,$F,$L,$E,$O,$H,$D"; AP="$M,$E,$O,$B,$D,$C"; AQ="$M,$O,$B,$D"; AR="$F,$L"; AS="$M,$F,$L,$D"; AT="$M,$G,$F,$L,$E,$O,$H,$B,$D,$J"; AU="$M,$E,$O,$D,$C"; AV="$M,$G,$L,$E,$O,$B,$D"; AW="$M,$G,$F,$L,$E,$O,$B,$D"; AX="$F,$B,$D"; AY="$M,$O,$D,$C"; AZ="$D,$C"; BA="$M,$A,$K,$F,$L,$E,$O,$B,$D,$C"; BB="$L,$E,$O,$D"; BC="$M,$H,$D,$C"; BD="$G,$I,$F,$L,$D,$C"; BE="$M,$G,$I,$F,$L,$E,$O,$B,$D,$J"; BF="$M,$N,$B,$D"; BG="$G,$F,$L,$E,$O,$H,$B,$D"; BH="$O"; BI="$M,$G,$O,$B,$D,$J"; BJ="$M,$N,$G,$F,$L,$E,$O,$B,$D,$J"; BK="$N,$B,$D"; BL="$M,$E,$D"; BM="$M,$B"; BN="$M,$G,$F,$L,$E,$O,$H,$D,$J"; BO="$M,$G,$A,$K,$F,$L,$E,$O,$H,$B,$D,$J,$C"; BP="$M,$F,$L,$D,$C"; BQ="$M,$N,$E,$O,$B,$D"; BR="$M,$G,$I,$F,$L,$E,$O,$D,$C"; BS="$G,$I"; BT="$M,$N,$E,$O,$D"; BU="$H,$B,$D"; BV="$M,$F,$L,$O,$D"; BW="$N,$O,$B,$D"; BX="$M,$F,$L,$E,$O,$D,$C"; BY="$M,$A,$B,$D"; BZ="$E,$B,$D"; CA="$M,$G,$D,$C"; CB="$M"; CC="$M,$B,$D,$C"; CD="$M,$F,$L,$E,$O,$B,$D"; CE="$M,$A,$D"; CF="$L,$D"; 
functions=($P $Q $R $S $T $U $U $U $U $U $T $V $W $T $T $T $P $X $T $Y $T $Z $U $T $P $T $T $T $AA $AB $T $AC $AD $T $U $U $U $AE $AB $T $AF $AF $Q $AG $Q $T $U $U $U $P $AH $P $P $AI $P $AJ $Q $AJ $AJ $T $T $U $T $T $AB $U $U $W $AK $AL $Q $Y $AI $X $W $AL $T $AM $T $X $T $W $Q $T $T $T $Q $AC $AD $AJ $AD $AL $AN $W $AC $U $U $AB $AO $U $AP $AJ $AL $AL $Q $T $T $AF $AH $T $AQ $U $T $Q $AR $Q $Q $T $T $P $AS $Z $AF $U $T $AT $U $Q $T $U $U $AA $AB $AU $U $T $X $T $T $T $T $T $Q $W $AB $AJ $Q $T $AO $Q $AV $AB $T $U $T $AV $U $AV $U $AW $T $AD $AX $AY $AC $Q $AZ $AL $AB $AD $U $Q $T $AG $AF $BA $AB $AB $BB $P $U $X $AC $AP $Q $AQ $T $AD $U $T $T $T $AQ $T $T $P $Q $AJ $BC $AU $T $Z $BD $Q $AC $T $Q $T $T $BA $BE $BF $U $AC $U $AU $T $BG $AQ $AD $AD $W $T $BH $U $AY $AB $Q $BI $U $Q $AQ $BJ $AY $AU $BK $AO $AD $AD $AB $T $AB $AB $U $T $AF $BL $AT $AY $Q $T $AH $P $AN $AX $T $AG $X $AB $AB $AB $AB $Q $BM $BN $AF $Q $AB $BO $BO $Q $Q $BP $BL $BL $AB $BQ $U $Q $AJ $Q $AS $U $W $AB $AS $AD $BR $BS $T $Q $T $BT $AP $U $T $Q $BU $T $BV $Q $Q $Q $X $T $AD $BW $AJ $AD $T $T $BX $U $Q $AB $T $BY $AI $AB $BZ $CA $T $AB $R $T $Q $U $Q $AB $AC $U $U $U $T $CB $T $T $T $Q $AJ $AJ $AJ $T $T $Q $U $AF $BO $AJ $BO $BO $AJ $AH $CB $T $AD $CC $T $CD $T $AR $AI $CE $AQ $U $Q $AY $AB $T $T $P $W $T $U $Q $BH $CF $U $AY $AL $T $U)
for (( i=0; i<${#gtfobins[@]}; i++ )); do
  if [ -z "$1" ] || [[ "${functions[$i]}" == *"$1"* ]]; then
    if which ${gtfobins[$i]} > /dev/null; then
      if [ -z "$1" ]; then
        printf "%-19s ${functions[$i]}\n" "${gtfobins[$i]}"
      else
        printf "%-19s https://gtfobins.github.io/gtfobins/${gtfobins[$i]}/#$ANCHOR\n" "${gtfobins[$i]}"
      fi
    fi
  fi
done
