#!/bin/bash

gtfobins=("7z" "aa-exec" "ab" "agetty" "alpine" "ansible-playbook" "ansible-test" "aoss" "apt-get" "apt" "ar" "aria2c" "arj" "arp" "as" "ascii-xfr" "ascii85" "ash" "aspell" "at" "atobm" "awk" "aws" "base32" "base58" "base64" "basenc" "basez" "bash" "batcat" "bc" "bconsole" "bpftrace" "bridge" "bundle" "bundler" "busctl" "busybox" "byebug" "bzip2" "c89" "c99" "cabal" "cancel" "capsh" "cat" "cdist" "certbot" "check_by_ssh" "check_cups" "check_log" "check_memory" "check_raid" "check_ssl_cert" "check_statusfile" "chmod" "choom" "chown" "chroot" "clamscan" "cmp" "cobc" "column" "comm" "composer" "cowsay" "cowthink" "cp" "cpan" "cpio" "cpulimit" "crash" "crontab" "csh" "csplit" "csvtool" "cupsfilter" "curl" "cut" "dash" "date" "dd" "debugfs" "dialog" "diff" "dig" "distcc" "dmesg" "dmidecode" "dmsetup" "dnf" "docker" "dos2unix" "dosbox" "dotnet" "dpkg" "dstat" "dvips" "easy_install" "eb" "ed" "efax" "elvish" "emacs" "env" "eqn" "espeak" "ex" "exiftool" "expand" "expect" "facter" "file" "find" "finger" "fish" "flock" "fmt" "fold" "fping" "ftp" "gawk" "gcc" "gcloud" "gcore" "gdb" "gem" "genie" "genisoimage" "ghc" "ghci" "gimp" "ginsh" "git" "grc" "grep" "gtester" "gzip" "hd" "head" "hexdump" "highlight" "hping3" "iconv" "iftop" "install" "ionice" "ip" "irb" "ispell" "jjs" "joe" "join" "journalctl" "jq" "jrunscript" "jtag" "julia" "knife" "ksh" "ksshell" "ksu" "kubectl" "latex" "latexmk" "ld.so" "ldconfig" "less" "lftp" "ln" "loginctl" "logsave" "look" "lp" "ltrace" "lua" "lualatex" "luatex" "lwp-download" "lwp-request" "mail" "make" "man" "mawk" "minicom" "more" "mosquitto" "mount" "msfconsole" "msgattrib" "msgcat" "msgconv" "msgfilter" "msgmerge" "msguniq" "mtr" "multitime" "mv" "mysql" "nano" "nasm" "nawk" "nc" "ncftp" "neofetch" "nft" "nice" "nl" "nm" "nmap" "node" "nohup" "npm" "nroff" "nsenter" "octave" "od" "openssl" "openvpn" "openvt" "opkg" "pandoc" "paste" "pax" "pdb" "pdflatex" "pdftex" "perf" "perl" "perlbug" "pexec" "pg" "php" "pic" "pico" "pidstat" "pip" "pkexec" "pkg" "posh" "pr" "pry" "psftp" "psql" "ptx" "puppet" "pwsh" "python" "rake" "rc" "readelf" "red" "redcarpet" "redis" "restic" "rev" "rlogin" "rlwrap" "rpm" "rpmdb" "rpmquery" "rpmverify" "rsync" "rtorrent" "ruby" "run-mailcap" "run-parts" "runscript" "rview" "rvim" "sash" "scanmem" "scp" "screen" "script" "scrot" "sed" "service" "setarch" "setfacl" "setlock" "sftp" "sg" "shuf" "slsh" "smbclient" "snap" "socat" "socket" "soelim" "softlimit" "sort" "split" "sqlite3" "sqlmap" "ss" "ssh-agent" "ssh-keygen" "ssh-keyscan" "ssh" "sshpass" "start-stop-daemon" "stdbuf" "strace" "strings" "su" "sysctl" "systemctl" "systemd-resolve" "tac" "tail" "tar" "task" "taskset" "tasksh" "tbl" "tclsh" "tcpdump" "tdbtool" "tee" "telnet" "terraform" "tex" "tftp" "tic" "time" "timedatectl" "timeout" "tmate" "tmux" "top" "torify" "torsocks" "troff" "tshark" "ul" "unexpand" "uniq" "unshare" "unsquashfs" "unzip" "update-alternatives" "uudecode" "uuencode" "vagrant" "valgrind" "vi" "view" "vigr" "vim" "vimdiff" "vipw" "virsh" "volatility" "w3m" "wall" "watch" "wc" "wget" "whiptail" "whois" "wireshark" "wish" "xargs" "xdg-user-dir" "xdotool" "xelatex" "xetex" "xmodmap" "xmore" "xpad" "xxd" "xz" "yarn" "yash" "yelp" "yum" "zathura" "zip" "zsh" "zsoelim" "zypper")
A="bind-shell"; B="capabilities"; C="command"; D="file-download"; E="file-read"; F="file-upload"; G="file-write"; H="library-load"; I="limited-suid"; J="non-interactive-bind-shell"; K="non-interactive-reverse-shell"; L="reverse-shell"; M="suid"; N="shell"; O="sudo"; P="$E,$O"; Q="$N,$M,$O"; R="$F,$D,$M,$O"; S="$M"; T="$E,$M,$O"; U="$N,$O"; V="$C,$D,$O,$I"; W="$G,$E,$M,$O"; X="$N,$G,$M,$O"; Y="$N,$C,$O"; Z="$N,$K,$J,$G,$E,$M,$O,$I"; AA="$N,$L,$F,$D,$G,$E,$H,$M,$O"; AB="$N,$O,$I"; AC="$N,$E,$O"; AD="$O"; AE="$N,$F,$G,$E,$M,$O"; AF="$N,$G,$E,$O"; AG="$F"; AH="$G,$E,$O"; AI="$C,$O"; AJ="$M,$O"; AK="$N,$L,$F,$D,$O"; AL="$N,$G,$E,$M,$O"; AM="$F,$D,$G,$E,$M,$O"; AN="$G"; AO="$N,$L,$F,$D,$G,$E,$H,$O"; AP="$N,$G,$E,$M,$O,$I"; AQ="$N,$E,$M,$O"; AR="$F,$D"; AS="$N,$F,$D,$O"; AT="$N,$L,$F,$D,$G,$E,$H,$M,$O,$B"; AU="$N,$G,$E,$O,$I"; AV="$N,$L,$D,$G,$E,$M,$O"; AW="$N,$L,$F,$D,$G,$E,$M,$O"; AX="$F,$M,$O"; AY="$N,$E,$O,$I"; AZ="$O,$I"; BA="$N,$K,$J,$F,$D,$G,$E,$M,$O,$I"; BB="$D,$G,$E,$O"; BC="$N,$H,$O,$I"; BD="$L,$A,$F,$D,$O,$I"; BE="$N,$L,$A,$F,$D,$G,$E,$M,$O,$B"; BF="$N,$C,$M,$O"; BG="$L,$F,$D,$G,$E,$H,$M,$O"; BH="$E"; BI="$N,$L,$E,$M,$O,$B"; BJ="$N,$C,$L,$F,$D,$G,$E,$M,$O,$B"; BK="$C,$M,$O"; BL="$N,$G,$O"; BM="$N,$M"; BN="$N,$L,$F,$D,$G,$E,$H,$O,$B"; BO="$N,$L,$K,$J,$F,$D,$G,$E,$H,$M,$O,$B,$I"; BP="$N,$F,$D,$O,$I"; BQ="$N,$C,$G,$E,$M,$O"; BR="$N,$L,$A,$F,$D,$G,$E,$O,$I"; BS="$L,$A"; BT="$N,$C,$G,$E,$O"; BU="$H,$M,$O"; BV="$N,$F,$D,$E,$O"; BW="$C,$E,$M,$O"; BX="$N,$F,$D,$G,$E,$O,$I"; BY="$N,$K,$M,$O"; BZ="$G,$M,$O"; CA="$N,$L,$O,$I"; CB="$N"; CC="$N,$M,$O,$I"; CD="$N,$F,$D,$G,$E,$M,$O"; CE="$N,$K,$O"; CF="$D,$O"; 
functions=($P $Q $R $S $T $U $U $U $U $U $T $V $W $T $T $T $P $X $T $Y $T $Z $U $T $P $T $T $T $AA $AB $T $AC $AD $T $U $U $U $AE $AB $T $AF $AF $Q $AG $Q $T $U $U $U $P $AH $P $P $AI $P $AJ $Q $AJ $AJ $T $T $U $T $T $AB $U $U $W $AK $AL $Q $Y $AI $X $W $AL $T $AM $T $X $T $W $Q $T $T $T $Q $AC $AD $AJ $AD $AL $AN $W $AC $U $U $AB $AO $U $AP $AJ $AL $AL $Q $T $T $AF $AH $T $AQ $U $T $Q $AR $Q $Q $T $T $P $AS $Z $AF $U $T $AT $U $Q $T $U $U $AA $AB $AU $U $T $X $T $T $T $T $T $Q $W $AB $AJ $Q $T $AO $Q $AV $AB $T $U $T $AV $U $AV $U $AW $T $AD $AX $AY $AC $Q $AZ $AL $AB $AD $U $Q $T $AG $AF $BA $AB $AB $BB $P $U $X $AC $AP $Q $AQ $T $AD $U $T $T $T $AQ $T $T $P $Q $AJ $BC $AU $T $Z $BD $Q $AC $T $Q $T $T $BA $BE $BF $U $AC $U $AU $T $BG $AQ $AD $AD $W $T $BH $U $AY $AB $Q $BI $U $Q $AQ $BJ $AY $AU $BK $AO $AD $AD $AB $T $AB $AB $U $T $AF $BL $AT $AY $Q $T $AH $P $AN $AX $T $AG $X $AB $AB $AB $AB $Q $BM $BN $AF $Q $AB $BO $BO $Q $Q $BP $BL $BL $AB $BQ $U $Q $AJ $Q $AS $U $W $AB $AS $AD $BR $BS $T $Q $T $BT $AP $U $T $Q $BU $T $BV $Q $Q $Q $X $T $AD $BW $AJ $AD $T $T $BX $U $Q $AB $T $BY $AI $AB $BZ $CA $T $AB $R $T $Q $U $Q $AB $AC $U $U $U $T $CB $T $T $T $Q $AJ $AJ $AJ $T $T $Q $U $AF $BO $AJ $BO $BO $AJ $AH $CB $T $AD $CC $T $CD $T $AR $AI $CE $AQ $U $Q $AY $AB $T $T $P $W $T $U $Q $BH $CF $U $AY $AL $T $U)
for (( i=0; i<${#gtfobins[@]}; i++ )); do
  if [ -z "$1" ] || [[ "${functions[$i]}" == *"$1"* ]]; then
    if which ${gtfobins[$i]} > /dev/null; then
      if [ -z "$1" ]; then
        printf "%-19s ${functions[$i]}\n" "${gtfobins[$i]}"
      else
        printf "%-19s https://gtfobins.github.io/gtfobins/${gtfobins[$i]}/#$1\n" "${gtfobins[$i]}"
      fi
    fi
  fi
done
