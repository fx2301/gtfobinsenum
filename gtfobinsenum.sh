#!/bin/bash

ANCHOR=$(echo "$1" | sed 's/\(.*\)/\L\1/' | tr ' ' '-')

gtfobins=("7z" "aa-exec" "ab" "agetty" "alpine" "ansible-playbook" "ansible-test" "aoss" "apt-get" "apt" "ar" "aria2c" "arj" "arp" "as" "ascii-xfr" "ascii85" "ash" "aspell" "at" "atobm" "awk" "aws" "base32" "base58" "base64" "basenc" "basez" "bash" "batcat" "bc" "bconsole" "bpftrace" "bridge" "bundle" "bundler" "busctl" "busybox" "byebug" "bzip2" "c89" "c99" "cabal" "cancel" "capsh" "cat" "cdist" "certbot" "check_by_ssh" "check_cups" "check_log" "check_memory" "check_raid" "check_ssl_cert" "check_statusfile" "chmod" "choom" "chown" "chroot" "clamscan" "cmp" "cobc" "column" "comm" "composer" "cowsay" "cowthink" "cp" "cpan" "cpio" "cpulimit" "crash" "crontab" "csh" "csplit" "csvtool" "cupsfilter" "curl" "cut" "dash" "date" "dd" "debugfs" "dialog" "diff" "dig" "distcc" "dmesg" "dmidecode" "dmsetup" "dnf" "docker" "dos2unix" "dosbox" "dotnet" "dpkg" "dstat" "dvips" "easy_install" "eb" "ed" "efax" "elvish" "emacs" "env" "eqn" "espeak" "ex" "exiftool" "expand" "expect" "facter" "file" "find" "finger" "fish" "flock" "fmt" "fold" "fping" "ftp" "gawk" "gcc" "gcloud" "gcore" "gdb" "gem" "genie" "genisoimage" "ghc" "ghci" "gimp" "ginsh" "git" "grc" "grep" "gtester" "gzip" "hd" "head" "hexdump" "highlight" "hping3" "iconv" "iftop" "install" "ionice" "ip" "irb" "ispell" "jjs" "joe" "join" "journalctl" "jq" "jrunscript" "jtag" "julia" "knife" "ksh" "ksshell" "ksu" "kubectl" "latex" "latexmk" "ld.so" "ldconfig" "less" "lftp" "ln" "loginctl" "logsave" "look" "lp" "ltrace" "lua" "lualatex" "luatex" "lwp-download" "lwp-request" "mail" "make" "man" "mawk" "minicom" "more" "mosquitto" "mount" "msfconsole" "msgattrib" "msgcat" "msgconv" "msgfilter" "msgmerge" "msguniq" "mtr" "multitime" "mv" "mysql" "nano" "nasm" "nawk" "nc" "ncftp" "neofetch" "nft" "nice" "nl" "nm" "nmap" "node" "nohup" "npm" "nroff" "nsenter" "octave" "od" "openssl" "openvpn" "openvt" "opkg" "pandoc" "paste" "pax" "pdb" "pdflatex" "pdftex" "perf" "perl" "perlbug" "pexec" "pg" "php" "pic" "pico" "pidstat" "pip" "pkexec" "pkg" "posh" "pr" "pry" "psftp" "psql" "ptx" "puppet" "pwsh" "python" "rake" "rc" "readelf" "red" "redcarpet" "redis" "restic" "rev" "rlogin" "rlwrap" "rpm" "rpmdb" "rpmquery" "rpmverify" "rsync" "rtorrent" "ruby" "run-mailcap" "run-parts" "runscript" "rview" "rvim" "sash" "scanmem" "scp" "screen" "script" "scrot" "sed" "service" "setarch" "setfacl" "setlock" "sftp" "sg" "shuf" "slsh" "smbclient" "snap" "socat" "socket" "soelim" "softlimit" "sort" "split" "sqlite3" "sqlmap" "ss" "ssh-agent" "ssh-keygen" "ssh-keyscan" "ssh" "sshpass" "start-stop-daemon" "stdbuf" "strace" "strings" "su" "sysctl" "systemctl" "systemd-resolve" "tac" "tail" "tar" "task" "taskset" "tasksh" "tbl" "tclsh" "tcpdump" "tdbtool" "tee" "telnet" "terraform" "tex" "tftp" "tic" "time" "timedatectl" "timeout" "tmate" "tmux" "top" "torify" "torsocks" "troff" "tshark" "ul" "unexpand" "uniq" "unshare" "unsquashfs" "unzip" "update-alternatives" "uudecode" "uuencode" "vagrant" "valgrind" "vi" "view" "vigr" "vim" "vimdiff" "vipw" "virsh" "volatility" "w3m" "wall" "watch" "wc" "wget" "whiptail" "whois" "wireshark" "wish" "xargs" "xdg-user-dir" "xdotool" "xelatex" "xetex" "xmodmap" "xmore" "xpad" "xxd" "xz" "yarn" "yash" "yelp" "yum" "zathura" "zip" "zsh" "zsoelim" "zypper")
A="File read,Sudo"; B="Shell,SUID,Sudo"; C="File upload,File download,SUID,Sudo"; D="SUID"; E="File read,SUID,Sudo"; F="Shell,Sudo"; G="Command,File download,Sudo,Limited SUID"; H="File write,File read,SUID,Sudo"; I="Shell,File write,SUID,Sudo"; J="Shell,Command,Sudo"; K="Shell,Non-interactive reverse shell,Non-interactive bind shell,File write,File read,SUID,Sudo,Limited SUID"; L="Shell,Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo"; M="Shell,Sudo,Limited SUID"; N="Shell,File read,Sudo"; O="Sudo"; P="Shell,File upload,File write,File read,SUID,Sudo"; Q="Shell,File write,File read,Sudo"; R="File upload"; S="File write,File read,Sudo"; T="Command,Sudo"; U="SUID,Sudo"; V="Shell,Reverse shell,File upload,File download,Sudo"; W="Shell,File write,File read,SUID,Sudo"; X="File upload,File download,File write,File read,SUID,Sudo"; Y="File write"; Z="Shell,Reverse shell,File upload,File download,File write,File read,Library load,Sudo"; AA="Shell,File write,File read,SUID,Sudo,Limited SUID"; AB="Shell,File read,SUID,Sudo"; AC="File upload,File download"; AD="Shell,File upload,File download,Sudo"; AE="Shell,Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities"; AF="Shell,File write,File read,Sudo,Limited SUID"; AG="Shell,Reverse shell,File download,File write,File read,SUID,Sudo"; AH="Shell,Reverse shell,File upload,File download,File write,File read,SUID,Sudo"; AI="File upload,SUID,Sudo"; AJ="Shell,File read,Sudo,Limited SUID"; AK="Sudo,Limited SUID"; AL="Shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,SUID,Sudo,Limited SUID"; AM="File download,File write,File read,Sudo"; AN="Shell,Library load,Sudo,Limited SUID"; AO="Reverse shell,Bind shell,File upload,File download,Sudo,Limited SUID"; AP="Shell,Reverse shell,Bind shell,File upload,File download,File write,File read,SUID,Sudo,Capabilities"; AQ="Shell,Command,SUID,Sudo"; AR="Reverse shell,File upload,File download,File write,File read,Library load,SUID,Sudo"; AS="File read"; AT="Shell,Reverse shell,File read,SUID,Sudo,Capabilities"; AU="Shell,Command,Reverse shell,File upload,File download,File write,File read,SUID,Sudo,Capabilities"; AV="Command,SUID,Sudo"; AW="Shell,File write,Sudo"; AX="Shell,SUID"; AY="Shell,Reverse shell,File upload,File download,File write,File read,Library load,Sudo,Capabilities"; AZ="Shell,Reverse shell,Non-interactive reverse shell,Non-interactive bind shell,File upload,File download,File write,File read,Library load,SUID,Sudo,Capabilities,Limited SUID"; BA="Shell,File upload,File download,Sudo,Limited SUID"; BB="Shell,Command,File write,File read,SUID,Sudo"; BC="Shell,Reverse shell,Bind shell,File upload,File download,File write,File read,Sudo,Limited SUID"; BD="Reverse shell,Bind shell"; BE="Shell,Command,File write,File read,Sudo"; BF="Library load,SUID,Sudo"; BG="Shell,File upload,File download,File read,Sudo"; BH="Command,File read,SUID,Sudo"; BI="Shell,File upload,File download,File write,File read,Sudo,Limited SUID"; BJ="Shell,Non-interactive reverse shell,SUID,Sudo"; BK="File write,SUID,Sudo"; BL="Shell,Reverse shell,Sudo,Limited SUID"; BM="Shell"; BN="Shell,SUID,Sudo,Limited SUID"; BO="Shell,File upload,File download,File write,File read,SUID,Sudo"; BP="Shell,Non-interactive reverse shell,Sudo"; BQ="File download,Sudo"; 
functions=($A $B $C $D $E $F $F $F $F $F $E $G $H $E $E $E $A $I $E $J $E $K $F $E $A $E $E $E $L $M $E $N $O $E $F $F $F $P $M $E $Q $Q $B $R $B $E $F $F $F $A $S $A $A $T $A $U $B $U $U $E $E $F $E $E $M $F $F $H $V $W $B $J $T $I $H $W $E $X $E $I $E $H $B $E $E $E $B $N $O $U $O $W $Y $H $N $F $F $M $Z $F $AA $U $W $W $B $E $E $Q $S $E $AB $F $E $B $AC $B $B $E $E $A $AD $K $Q $F $E $AE $F $B $E $F $F $L $M $AF $F $E $I $E $E $E $E $E $B $H $M $U $B $E $Z $B $AG $M $E $F $E $AG $F $AG $F $AH $E $O $AI $AJ $N $B $AK $W $M $O $F $B $E $R $Q $AL $M $M $AM $A $F $I $N $AA $B $AB $E $O $F $E $E $E $AB $E $E $A $B $U $AN $AF $E $K $AO $B $N $E $B $E $E $AL $AP $AQ $F $N $F $AF $E $AR $AB $O $O $H $E $AS $F $AJ $M $B $AT $F $B $AB $AU $AJ $AF $AV $Z $O $O $M $E $M $M $F $E $Q $AW $AE $AJ $B $E $S $A $Y $AI $E $R $I $M $M $M $M $B $AX $AY $Q $B $M $AZ $AZ $B $B $BA $AW $AW $M $BB $F $B $U $B $AD $F $H $M $AD $O $BC $BD $E $B $E $BE $AA $F $E $B $BF $E $BG $B $B $B $I $E $O $BH $U $O $E $E $BI $F $B $M $E $BJ $T $M $BK $BL $E $M $C $E $B $F $B $M $N $F $F $F $E $BM $E $E $E $B $U $U $U $E $E $B $F $Q $AZ $U $AZ $AZ $U $S $BM $E $O $BN $E $BO $E $AC $T $BP $AB $F $B $AJ $M $E $E $A $H $E $F $B $AS $BQ $F $AJ $W $E $F)
for (( i=0; i<${#gtfobins[@]}; i++ )); do
  if [ -z "$1" ] || [[ "${functions[$i]}" == *"$1"* ]]; then
    if which ${gtfobins[$i]} > /dev/null; then
      if [ -z "$1" ]; then
        printf "%-19s ${functions[$i]}\n" "${gtfobins[$i]}"
      else
        printf "%-19s https://gtfobins.github.io/gtfobins/${gtfobins[$i]}/#$ANCHOR\n" "${gtfobins[$i]}"
      fi
    fi
  fi
done
